:root{
  --bg:#0b0c10; --muted:#9aa3b2;
  --accent:#6ee7b7; --accent-orange:#FF7700;
  --preview-bg:#0b0f1a;

  --ctl-h: 36px;
  --btn-font: 13px;
  --btn-pad-y: 8px;
  --btn-pad-x: 12px;
  --btn-radius: 12px;

  --wrap-r: 16px;
  --btn-dim-bg: #525b72;

  /* расстояние между превью и кнопками */
  --stack-gap: 24px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  background:linear-gradient(180deg,#0b0c10,#0f1117);
  color:#eef2f8;
}

.page{
  min-height:100dvh;
  display:grid;
  place-items:center;
  padding:16px;
}

.app{
  width:100%;
  max-width:1000px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:var(--stack-gap);
}

/* ==== превью-коробка ==== */
.wrapper{
  position:relative; width:360px; height:800px;
  border:none; outline:none;
  border-radius:var(--wrap-r);
  overflow:visible;
}
.wrapper::after{
  content:"";
  position:absolute;
  inset:-6px;
  border:2px dashed #2b334a;
  border-radius: calc(var(--wrap-r) + 6px);
  pointer-events:none;
  z-index:2;
}
.preview{ position:absolute; inset:0; overflow:hidden; z-index:1; background:var(--preview-bg); }

.bg, .lottie-layer, .overlay{ position:absolute; inset:0; }
.bg{ overflow:hidden; display:flex; align-items:center; justify-content:center; }
.bg img{ display:block; height:100%; width:auto; margin:0 auto; }

.lottie-layer{ overflow:hidden; }
.lot-stage{
  position:absolute;
  left:50%; top:50%;
  transform-origin:50% 50%;
}
.lottie-mount{ width:100%; height:100%; }

/* подсветка Lottie */
.lot-stage::after{
  content:"";
  position:absolute; inset:0;
  border:1px dashed rgba(255,255,255,.45);
  background:rgba(255,255,255,.08);
  opacity:0; pointer-events:none; border-radius:8px;
}
.lot-stage.hover::after{ opacity:1; }
.lot-stage.dragging::after{ opacity:1; background:rgba(255,255,255,.18); }

/* overlay над всем */
.overlay{ display:flex; align-items:center; justify-content:center; z-index:2; }
.overlay img{ display:block; height:100%; width:auto; margin:0 auto; transition:opacity .15s ease; }
.overlay.dim img{ opacity:.2; }

/* плейсхолдер */
.placeholder{
  position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
  color:var(--muted); font-size:13px; letter-spacing:.2px; background:var(--preview-bg);
  border:none; border-radius:12px; text-align:center; padding:12px;
}
.placeholder .ph{ display:flex; flex-direction:column; align-items:center; }
.placeholder .ph-1{ color:#fff; margin-bottom:4px; font-weight:600; }
.placeholder .ph-2{ color:var(--muted); }
.placeholder.hidden{ display:none; }

/* DnD overlay */
.drop-overlay{
  position:absolute; inset:0;
  display:none; align-items:center; justify-content:center;
  z-index:5; pointer-events:none;
}
.drop-overlay .grid{
  display:grid; grid-template-columns:1fr 1fr 1fr; gap:8px;
  width:95%; max-width:900px;
}
.drop-overlay .zone{
  border:2px dashed #2b334a; color:#ddd; padding:14px 18px; border-radius:10px; font-size:13px;
  background:rgba(0,0,0,.35); text-align:center;
}
body.dragging .drop-overlay{ display:flex; }

/* ==== панель кнопок ==== */
.controls{
  width:100%;
  display:flex; align-items:center; justify-content:center;
  gap:8px; flex-wrap:wrap;
  background:transparent; padding:0; border:none;
}

.btn{
  cursor:pointer; border:none; border-radius:var(--btn-radius);
  padding:var(--btn-pad-y) var(--btn-pad-x);
  font-weight:600; font-size:var(--btn-font); line-height:1;
  min-height:var(--ctl-h);
  display:inline-flex; align-items:center; justify-content:center; gap:6px;
  transition:transform .05s ease, opacity .2s ease, filter .2s ease;
  color:#0b0c10; background:var(--accent);
}
.btn:disabled{opacity:.5; cursor:not-allowed}
.btn:active{transform:translateY(1px)}
.btn:hover:not(:disabled){ filter:brightness(1.05); }

.btn.secondary { background:#273046; color:#dce3ef; border:1px solid #2e374f; }
.btn.accent    { background:var(--accent-orange); color:#fff; }
.btn.ghost     { background:transparent; color:#dce3ef; border:1px dashed #2e374f; }
.btn.subtle    { background:#1f2638; color:#dce3ef; border:1px solid #2a3350; }

/* лоудер на share */
.btn.loading{ opacity:.95; pointer-events:none; position:relative; }
.btn.loading::after{
  content:""; width:14px; height:14px; margin-left:6px;
  border:2px solid rgba(255,255,255,.35);
  border-top-color:#fff; border-right-color:#fff;
  border-radius:50%; display:inline-block; animation:spin .6s linear infinite; vertical-align:middle;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* HUD */
.pos-hud{
  position:absolute; left:8px; bottom:8px; z-index:6;
  font-size:12px; color:#e3e9f5; background:rgba(0,0,0,.5);
  padding:4px 6px; border-radius:6px; pointer-events:none; user-select:none;
  opacity:.9;
}

/* тост */
.toast{
  position:fixed; padding:8px 10px; background:rgba(0,0,0,.85); color:#fff; border-radius:8px;
  font-size:12px; opacity:0; pointer-events:none; transition:opacity .15s ease-out;
  z-index:1000; backdrop-filter:blur(4px);
  transform:translate(-50%, calc(-100% - 8px));
}
.toast.show{ opacity:1; }

/* версия */
.ver{
  position:fixed; right:8px; bottom:6px; z-index:1000;
  font-size:11px; line-height:1; padding:4px 6px; color:#bbb;
  background:rgba(0,0,0,.4); border-radius:6px; pointer-events:none; user-select:none;
}

/* ==== мобайл / PWA ==== */
body.is-mobile .page{ padding:0; }
body.is-mobile .app{ max-width:none; }
body.is-mobile .controls{ display:none !important; }
body.is-mobile{ overflow:hidden; }
body.is-mobile .wrapper{
  position:fixed; inset:0; width:100vw; height:100dvh; background:#000;
  border-radius:0; --wrap-r: 0px;
}
body.is-mobile .preview{
  left:50%; top:50%; transform-origin:50% 50%;
}
body.is-mobile .ver{ display:none !important; }
