/* ===================== Т О К Е Н Ы  И  Б А З А ===================== */
:root{
  --bg:#0b0c10; --muted:#9aa3b2;
  --accent:#6ee7b7; --accent-orange:#FF7700;
  --preview-bg:#0b0f1a;

  /* UI-параметры */
  --ctl-h: 36px;           /* высота кнопки */
  --btn-font: 13px;        /* размер шрифта в кнопке */
  --btn-pad-y: 8px;
  --btn-pad-x: 12px;
  --btn-radius: 12px;
  --wrap-r: 16px;          /* радиус короба превью */
  --btn-dim-bg: #525b72;   /* цвет кнопок ширины/высоты */

  /* [ANCHOR:STACK_GAP] — расстояние между превью и блоком кнопок */
  --stack-gap: 18px;

  --toast-bg: rgba(0,0,0,0.8);
  --toast-fg: #fff;
}

*{ box-sizing:border-box; }
html,body{ height:100%; }
html{ background:var(--bg); color:#e5e7eb; }
body{
  margin:0;
  font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ===================== Р А З М Е Т К А ===================== */

.page{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:24px;
}

.app{
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:var(--stack-gap);
}

/* Коробка превью */
.wrapper{
  position:relative; width:360px; height:800px;
  border:none; outline:none;
  border-radius:var(--wrap-r);
  overflow:visible;              /* чтобы рамку не клипало */
}

/* Единственная пунктирная рамка */
.wrapper::after{
  content:"";
  position:absolute;
  inset:-6px;
  border:2px dashed #2b334a;
  border-radius: calc(var(--wrap-r) + 6px);
  pointer-events:none;
  z-index:2;
}

/* Внутреннее содержимое */
.preview{ position:absolute; inset:0; overflow:hidden; z-index:1; }

.bg, .lottie-layer{ position:absolute; inset:0; }
.bg{ overflow:hidden; display:flex; align-items:center; justify-content:center; }
.bg img{ display:block; height:100%; width:auto; margin:0 auto; }

.lottie-layer{ overflow:hidden; }
.lot-stage{
  position:absolute; left:50%; top:50%;
  transform-origin:50% 50%;
}
.lottie-mount{ width:100%; height:100%; }

/* Плейсхолдер — центр */
.placeholder{
  position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
  color:var(--muted); text-align:center; z-index:0;
}
.placeholder .ph{ display:flex; flex-direction:column; gap:6px; }
.placeholder .ph-1{ font-size:16px; opacity:.85; }
.placeholder .ph-2{ font-size:14px; opacity:.65; }

/* Оверлей DnD */
.drop-overlay{
  position:absolute; inset:0; display:none; align-items:center; justify-content:center;
  z-index:3;
}
.drop-overlay .box{
  background: rgba(110, 231, 183, 0.1);
  border:1px dashed var(--accent);
  color:#d1fae5;
  padding:12px 16px; border-radius:12px;
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

/* ===================== К Н О П К И / К О Н Т Р О Л Ы ===================== */

.controls{
  display:flex; flex-wrap:wrap; gap:10px;
  align-items:center; justify-content:center;
}

.btn{
  height:var(--ctl-h);
  padding: var(--btn-pad-y) var(--btn-pad-x);
  border-radius: var(--btn-radius);
  border:none; outline:none;
  background:#1f2637; color:#e5e7eb;
  font-weight:600; font-size:var(--btn-font);
  cursor:pointer;
  transition: transform .06s ease, background .15s ease, box-shadow .15s ease;
  box-shadow: 0 1px 0 rgba(255,255,255,0.06) inset, 0 1px 10px rgba(0,0,0,.2);
}
.btn:hover{ transform: translateY(-1px); background:#242c40; }
.btn:active{ transform: translateY(0); }

.btn.primary   { background: var(--btn-dim-bg); }
.btn.secondary { background: #394057; }
.btn.accent    { background: linear-gradient(180deg, #17cfa5, #0bb68f); color:#012318; }
.btn.accent:hover { background: linear-gradient(180deg, #1ce7ba, #10cf9f); }
.btn[disabled]{ opacity:.5; cursor:default; transform:none; }

.chk{ display:inline-flex; align-items:center; gap:8px; user-select:none; }
.chk input{ width:16px; height:16px; }

/* ===================== Т О С Т ===================== */

.toast{
  position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
  background: var(--toast-bg); color: var(--toast-fg);
  padding:10px 14px; border-radius:10px;
  opacity:0; pointer-events:none; transition: opacity .2s ease, transform .2s ease;
  z-index:99; white-space:nowrap;
}
.toast.show{ opacity:1; transform:translateX(-50%) translateY(-6px); }

/* ===================== В Е Р С И Я ===================== */

.ver{
  position:fixed; right:12px; bottom:10px;
  opacity:.5; font-size:12px; letter-spacing:.2px;
  user-select:none; z-index:20;
}

/* ===================== С О С Т О Я Н И Я ===================== */

.is-dragging .drop-overlay{ display:flex; }
.is-dragging .wrapper::after{ border-color: var(--accent); }

/* Когда есть контент — убираем плейсхолдер */
.has-bg .placeholder,
.has-lottie .placeholder{ display:none; }

/* ===================== А Д А П Т И В ===================== */

@media (max-width: 480px){
  .page{ padding:16px; }
}

/* “Мобильный режим” (если потребуется принудительно) */
body.is-mobile .page{ padding:0; }
body.is-mobile .app{ max_width:none; }
body.is-mobile .controls{ display:none !important; }
body.is-mobile{ overflow:hidden; }
body.is-mobile .wrapper{
  position:fixed; inset:0; width:100vw; height:100dvh; background:#000;
  border-radius:0; --wrap-r: 0px;
}
body.is-mobile .preview{
  width:360px;
  left:50%; top:50%; transform-origin:50% 50%;
  /* height и transform выставляет JS */
}
body.is-mobile .ver{ display:none !important; }

/* ===================== STANDALONE (A2HS) ===================== */
/* Только при запуске с иконки (класс .standalone мы добавляем на <html> в index.html) */
html.standalone, html.standalone body {
  background: #000;
  height: 100%;
  overflow: hidden;
}

/* Растягиваем контейнеры на экран */
html.standalone .page,
html.standalone .app,
html.standalone #wrapper,
html.standalone #preview{
  width: 100vw;
  height: 100dvh;
  margin: 0; padding: 0; border: 0;
}

/* Убираем пунктирную рамку только в standalone */
html.standalone .wrapper::after{
  display: none !important;
}

/* Скрываем вспомогательный UI */
html.standalone .controls,
html.standalone .drop-overlay,
html.standalone .placeholder{
  display: none !important;
}

/* Фон: ровно по ширине экрана, без клиппинга */
html.standalone .bg, 
html.standalone .bg img{
  position: absolute;
  inset: 0;
}
html.standalone .bg img{
  width: 100vw;
  height: auto;
  max-height: 100dvh;
  margin: 0 auto;
  display: block;
}

/* Lottie остаётся по центру (1:1), pointer-events отключены */
html.standalone .lottie-layer, 
html.standalone .lot-stage, 
html.standalone .lottie-mount{
  pointer-events: none;
}
